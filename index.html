<!DOCTYPE html>
<html lang="en" data-bs-theme="dark">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Excel Data Validation Tool</title>
    <link rel="stylesheet" href="https://cdn.replit.com/agent/bootstrap-agent-dark-theme.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
</head>
<body>
    <div class="container py-4">
        <header class="pb-3 mb-4 border-bottom">
            <div class="d-flex align-items-center text-white">
                <i class="bi bi-check-circle-fill me-3 fs-2 text-success"></i>
                <h1 class="fs-4 fw-bold">Excel Data Validation Tool</h1>
            </div>
        </header>

        <div class="p-4 mb-4 bg-body-tertiary rounded-3">
            <div class="container-fluid">
                <h2 class="mb-3">AI-Powered Data Validation</h2>
                <p class="mb-4">
                    Upload your  data file and validation rules file to check for inconsistencies and errors in your data. 
                    The validation tool will use AI to analyze your data according to the specified rules.
                </p>
                
                <!-- Alert for errors -->
                <div id="error-alert" class="alert alert-danger alert-dismissible fade show d-none" role="alert">
                    <i class="bi bi-exclamation-triangle-fill me-2"></i>
                    <span id="error-text">Error message will appear here</span>
                    <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
                </div>
                
                <!-- File upload form -->
                <form id="upload-form" enctype="multipart/form-data">
                    <div class="row">
                        <div class="col-md-6 file-upload-container">
                            <h4 class="mb-3">Data File</h4>
                            <label for="data-file" class="file-upload-label">
                                <i class="bi bi-file-earmark-excel upload-icon"></i>
                                <span class="choose-text">Choose Data  File</span>
                                <small class="text-muted d-block">Upload the  file containing your data.</small>
                            </label>
                            <input type="file" id="data-file" name="data_file" class="file-upload-input" >
                        </div>
                        
                        <div class="col-md-6 file-upload-container">
                            <h4 class="mb-3">Validation Rules</h4>
                            <label for="rules-file" class="file-upload-label">
                                <i class="bi bi-list-check upload-icon"></i>
                                <span class="choose-text">Choose Rules  File</span>
                                <small class="text-muted d-block">Upload the  file containing validation rules.</small>
                            </label>
                            <input type="file" id="rules-file" name="rules_file" class="file-upload-input" >
                        </div>
                    </div>
                    
                    <div class="d-grid gap-2 d-md-flex justify-content-md-center mt-4">
                        <button type="submit" id="upload-button" class="btn btn-primary btn-lg px-4" >
                            <i class="bi bi-check-circle me-2"></i>Validate Data
                        </button>
                    </div>
                    
                    <!-- Loading spinner -->
                    <div id="loading-spinner" class="spinner-container d-none">
                        <div class="spinner-border text-primary" role="status">
                            <span class="visually-hidden">Loading...</span>
                        </div>
                        <p class="mt-2">Processing validation, please wait...</p>
                    </div>
                </form>
            </div>
        </div>
        
        <div class="row mb-4">
            <div class="col-md-6">
                <div class="h-100 p-4 bg-body-tertiary border rounded-3">
                    <h3>Data File Format</h3>
                    <p>Your data  file should contain the dataset you want to validate. The tool supports multiple sheets.</p>
                    <ul>
                        <li>First row should contain column headers</li>
                        <li>Each subsequent row contains data to be validated</li>
                        <li>All data types are supported (text, numbers, dates, etc.)</li>
                    </ul>
                </div>
            </div>
            
            <div class="col-md-6">
                <div class="h-100 p-4 bg-body-tertiary border rounded-3">
                    <h3>Validation Rules Format</h3>
                    <p>Your rules  file should define validation criteria for columns in your data file.</p>
                    <ul>
                        <li>Column 1: The name of the column in your data file</li>
                        <li>Column 2: The validation rule (e.g., "should not be empty", "should be integer")</li>
                        <li>Multiple rules for the same column are supported</li>
                        <li>Complex conditions with AND/OR operators are supported</li>
                    </ul>
                </div>
            </div>
        </div>
        
        <footer class="pt-3 mt-4 text-body-secondary border-top">
            &copy; 2025 Excel Data Validation Tool
        </footer>
    </div>
    
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="{{ url_for('static', filename='js/main.js') }}"></script>
  
</body>
</html>
